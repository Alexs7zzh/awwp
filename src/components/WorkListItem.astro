---
import type { CollectionEntry } from 'astro:content';
import { Picture } from 'astro:assets';

interface Props {
  work: CollectionEntry<'work'>;
}

const { work } = Astro.props;
---

<li>
  <a href={`/${work.id}`}>
    <div class="work-info">
      <div class="title-year-column">
        <h3>{work.data.title}</h3>
        <p class="year">{work.data.year}</p>
      </div>
      <div class="intro-keywords-column">
        <p class="intro">{work.data.intro}</p>
        <p class="keywords">{work.data.keywords.join(', ')}</p>
      </div>
      <div class="image-list-column">
        <div class="image-list-container">
          {work.data.imgs.map(image => (
            <Picture 
              src={image.url} 
              alt={image.label} 
              formats={['avif', 'webp']}
              widths={[360, 480, 720]}
              class="list-image"
            />
          ))}
        </div>
      </div>
    </div>
  </a>
</li>

<style>
  li {
    list-style: none;
    width: 100%;
    border-bottom: 1px solid #a1a1a1;
  }

  li:last-child {
    border-bottom: none;
  }

  a {
    text-decoration: none;
    color: inherit;
    display: block;
    padding: 3rem 2rem;
    transition: background-color 0.2s;
  }
  
  /* Base styles (Mobile-first: smallest screens < 701px) */
  .work-info {
    display: grid;
    grid-template-columns: 1fr; /* Single column */
    align-items: start;
    gap: 1rem;
    width: 100%;
  }

  h3 {
    margin: 0 0 0.25rem 0;
    font-weight: bold;
    color: #000;
  }

  .year {
    font-size: 0.9em;
    color: #666;
  }

  .intro {
    overflow: hidden;
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-line-clamp: 3;
    margin-bottom: 0.5rem;
  }

  .keywords {
    font-size: 0.85em;
    color: #777;
  }

  .image-list-container {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
    justify-content: flex-start; /* Align images left on mobile */
  }

  .list-image {
    display: block;
    max-height: 100px;
    width: auto;
    flex: 0 0 auto;
  }

  /* Medium screens (>= 701px) - Two-column layout */
  @media (min-width: 701px) {
    .work-info {
      grid-template-columns: auto 50%;
      grid-template-rows: auto 1fr;
      gap: 1.5rem;
    }

    .title-year-column {
      grid-column: 1 / 2;
      grid-row: 1 / 2;
    }

    .intro-keywords-column {
      grid-column: 1 / 2;
      grid-row: 2 / 3;
    }

    .image-list-column {
      grid-column: 2 / 3;
      grid-row: 1 / 3;
      align-self: start;
    }
  }

  /* Large screens (>= 1051px) - Three-column layout */
  @media (min-width: 1051px) {
    .work-info {
      grid-template-columns: 20% 30% auto; /* Three columns */
      grid-template-rows: auto; /* Reset rows */
      gap: 3rem;
    }
    
    /* Reset grid placements for 3 columns */
    .title-year-column {
        grid-column: 1 / 2;
        grid-row: 1 / 2;
    }
    .intro-keywords-column {
        grid-column: 2 / 3;
        grid-row: 1 / 2;
    }
    .image-list-column {
        grid-column: 3 / 4;
        grid-row: 1 / 2;
    }
  }
</style>